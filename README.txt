3_CODE
│
├─ 3.1_1_Filtration
│   ├─ Filtration                — Batch filtering of EEG/fNIRS/Pulse/GSR/HR/RR.
│   └─ Filtration_with_visualization    — Batch filtering of EEG, fNIRS, pulse, GSR, HR, and RR signals, with optional multi-channel visualization before and after filtering.
│
├─ 3.2_2_Split_into_Meditation_Normal
│   ├─ Split_EEG                 — Align to GSR, split EEG into before/meditation/after.
│   ├─ Split_fNIRS               — Align to GSR, split fNIRS into before/meditation/after.
│   ├─ Split_GSR_HR_RR_Pulse     — Sync GSR/HR/RR/Pulse, segment into phases 1–3.
│   ├─ Split_EEG_visual                 — Align to GSR, split EEG into before/meditation/after, with optional visualization of signal splited into 3 phases by markers.
│   ├─ Split_fNIRS_visual               — Align to GSR, split fNIRS into before/meditation/after, with optional visualization of signal splited into 3 phases by markers.
│   ├─ Split_GSR_HR_RR_Pulse_visual     — Sync GSR/HR/RR/Pulse, segment into phases 1–3, with optional visualization of signal splited into 3 phases by markers.
│   └─ Preparation_for_tsfresh_library — Merge segments into datasets for feature extraction.
│
├─ 3.3_3_tsfresh
│   ├─ Tsfresh_EEG_fNIRS         — Merge phases 1+3 = “Normal”, extract features.
│   └─ Tsfresh_GSR_HR_RR_Pulse   — Extract features (GSR/HR/RR) from “else_phase_edited”.
│
├─ 3.4_4_RFECV
│   ├─ RFECV_EEG                 — RFECV on EEG features, select and visualize top features.
│   ├─ RFECV_RR                  — RFECV on modality (e.g., RR), export top features.
│   └─ Filtering_based_on_RFECV  — Filter CSVs to selected (top) features.
│
└─ 3.5_5_LDA
    ├─ LDA_statistical_analysis_EEG — LDA on EEG, LD1 significance, boxplot.
    └─ LDA_statistical_analysis_GSR — LDA for two groups, stats and plots.

------------------------------------------------------------------------------------------------------------
MATLAB Environment
- MATLAB: R2023b Update 6 (23.2.0.2485118) on Windows 11
- Required Toolboxes:
  • Signal Processing Toolbox
  • Statistics and Machine Learning Toolbox
- Optional:
  • Parallel Computing Toolbox

Verify on target machine:
ver('matlab'); ver('signal'); ver('stats');
license('test','Signal_Toolbox'); license('test','Statistics_Toolbox');

-------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------
# Overview (in folder DATA)
# This directory contains results generated by the refactored analysis pipeline.
# Key points:
# • Easier use: no interactive prompts; scripts auto-resolve the dataset root via
#   _last_out_root.txt or the newest Processed_* directory.
# • Batch-ready: processes all measurement folders recursively; missing files are skipped.
# • Reproducible layout: outputs are written to TSFRESH_merged → FeatureSelection →
#   FilteredBasedOnRFECV → LDA in a fixed structure.
# Scope control:
# • All participants: run as-is (default traversal).
# • Single participant: set _last_out_root.txt / BASE_DIR to that participant’s folder
#   (e.g., …/Filtered_/p7_YYYY.MM) and run the scripts to generate outputs only for that subject.


Filtered_ …                               # root — code outputs (runs by new users)
├─ 1. PX_date.month                        # measurement folder for a specific participant & day (e.g., p7_2025.10)
│  ├─ 1.1 Y_filtered                       # pre-filtered signals (e.g., EEG_filtered.mat, GSR_filtered.csv, …)
│  ├─ 1.2 EEG_phases                       # EEG_phase.mat — EEG split into pre / meditation / post
│  ├─ 1.3 fNIRS_phases                     # fNIRS_phase.mat — fNIRS split into pre / meditation / post
│  ├─ 1.4 GSR_HR_RR_Pulse_segments         # GSR_HR_RR_Pulse_segments.mat — per-phase tables (Time,GSR,HR,RR,Pulse)
│  ├─ 1.5 EEG_phase_edited                 # EEG_phase_edited.mat — concatenated (pre+med+post) + last row = phase labels
│  ├─ 1.6 EEG_phase_edited                 # (likely should be fNIRS_phase_edited.mat) — same idea for fNIRS
│  └─ 1.7 else_phase_edited                # else_phase_edited.mat — “other” signals (GSR/HR/RR/Pulse) merged
│
├─ 2. TSFRESH_merged                       # TSFRESH feature outputs merged per participant
│  └─ 2.1 PX_Y_data                        # CSV: pX_Y_data.csv (rows: M1_Meditation / M1_Normal …; columns: features)
│
├─ 3. FeatureSelection                     # RFECV feature selection results + visualizations
│  └─ 3.1 Y                                # modality (EEG / fNIRS / GSR / HR / RR / Pulse)
│     └─ 3.1.1 PX                          # participant (pX)
│        ├─ 3.1.1.1 selected_features_pX_Y # CSV list of selected features with importances
│        ├─ 3.1.1.2 pX_Y_feature_importance# PNG: bar chart of all feature importances
│        └─ 3.1.1.3 pX_Y_top_z_features    # PNG: top-z features (e.g., top_40)
│
├─ 4. FilteredBasedOnRFECV                 # original TSFRESH CSVs filtered to selected features only
│  └─ 4.1 Y                                # modality
│     └─ 4.1.1 PX                          # participant
│        └─ 4.1.1.1 pX_Y_filtered          # CSV: pX_Y_filtered.csv (only columns from selected_features_pX_Y)
│
└─ 5. LDA                                  # LDA analysis results on Filtered/
   └─ 5.1 Y                                # modality (EEG, fNIRS, …)
      └─ 5.1.1 PX                          # participant
         ├─ 5.1.1.1 Lda_feature_contributions # CSV: variable contributions to LD components (scalings_/coef_)
         ├─ 5.1.1.2 Lda_results               # CSV: test used, p-value, significance for LD components
         └─ 5.1.1.3 Lda_boxplot               # PNG: LD1 boxplot (or LD1×LD2 scatter if multiple components)